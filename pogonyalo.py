import json
import random
import pytz
from datetime import time
from telegram import Update, ReplyKeyboardMarkup
from telegram.ext import ApplicationBuilder, CommandHandler, MessageHandler, ContextTypes, filters

# ==== –ù–ê–°–¢–†–û–ô–ö–ò ====
TOKEN = "8384986879:AAGUBtm3Fg0cNUa-IlroraoWQ1M7eMz2PNM"
BTN_GEN = "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–≥–æ–Ω—è–ª–æ"

# —Ç–≤–æ–π —Å–ø–∏—Å–æ–∫
NICKNAMES = [
    "–õ–µ–ø–º–∞–Ω –ö–æ—Ä–∏—á–Ω–µ–≤—ã–π –ó–º–µ–π", "–õ–µ–ø–º–∞–Ω –ú–∞—Ä–∞—Ñ–æ–Ω –ö–æ—Ä–∏—á–Ω–µ–≤—ã—Ö –ó–º–µ–π", "–õ–µ–ø–º–∞–Ω –°–Ω—é—Å–Ω—ã–π –ë–∞—Ä–æ–Ω", "–õ–µ–ø–º–∞–Ω –ö–æ—Ä–æ–ª—å –ñ–µ–ª—Ç—ã—Ö –î–æ–∂–¥–µ–π",
    "–õ–µ–ø–º–∞–Ω –õ–∏–Ω—å—á–∏–∫–æ–≤—ã–π –õ–µ–∂—É–Ω", "–õ–µ–ø–º–∞–Ω –ñ–∏–≤–æ—Ç–∏–∫+2–∫–≥", "–õ–µ–ø–º–∞–Ω –ë–∞–ª–¥—É –ü–∏–Ω–∞—Ç–µ–ª—å", "–õ–µ–ø–º–∞–Ω –£–Ω–∏—Ç–∞–∑ ‚Äî –≠—Ç–æ –ñ–∏–∑–Ω—å",
    "–õ–µ–ø–º–∞–Ω –ñ–µ–ª–µ–∑–Ω—ã–π –°–Ω—é—Å–æ–Ω–æ—Å–µ—Ü", "–õ–µ–ø–º–∞–Ω –¢–∏—Ç–∞–Ω –ü–æ–¥–æ–∫–æ–Ω–Ω–∏–∫–∞", "–õ–µ–ø–º–∞–Ω –í–ª–∞—Å—Ç–µ–ª–∏–Ω –õ—é–∫—Å–∞", "–õ–µ–ø–º–∞–Ω –ü–∞–ø–∞ –õ–∏–Ω—å—á–∏–∫–∞",
    "–õ–µ–ø–º–∞–Ω –ì—Ä–æ–∑–∞ –û–∫–æ–Ω", "–õ–µ–ø–º–∞–Ω –®–ª—ë–ø –£—Ç—Ä–µ–Ω–Ω–∏–π", "–õ–µ–ø–º–∞–Ω –ö–Ω–∏–≥–∞-–ú–æ—á–∞", "–õ–µ–ø–º–∞–Ω –õ–µ–∂–∏—Ç –ò –ö—Ä–∞—Å–∏–≤—ã–π",
    "–õ–µ–ø–º–∞–Ω 110 –ö–æ—Ä–∏—á–Ω–µ–≤—ã–π", "–õ–µ–ø–º–∞–Ω –° –ü—Ä–æ–¥—Ä–∏—Å—Ç—å—é", "–õ–µ–ø–º–∞–Ω –í–µ—á–Ω—ã–π –ë–∞–ª–∞–±–æ–ª", "–õ–µ–ø–º–∞–Ω –ö—Ä—É–≥ –°–∞–º–æ–ø–æ—Ç–µ—Ä—è–Ω–Ω—ã—Ö",
    "–í–µ—Ä—Ö–æ–≤–Ω—ã–π –ë—É—à–∏—Å—Ç",
    "–ì–ª–∞–≤–Ω—ã–π –ê–Ω—É—Å", "–ö–∏—à–∫–∞-–ü–æ–∂–∏—Ä–∞—Ç–µ–ª—å", "–ë—É—à–∏—Å—Ç—ã–π –ü–æ–¥–∑–∞–ª—É–ø–∏–Ω", "–ê–Ω—É—Å–æ–Ω–æ—Å–µ—Ü", "–ö–∏—à–∫–∞ –õ–∏–Ω—å—á–∏–∫–æ–≤–∞—è",
    "–ü–æ–≤–µ–ª–∏—Ç–µ–ª—å –ë—É—à–∏–∑–º–∞ –∏ –ê–Ω—É—Å–æ–≤", "–°–∏–ø–∞—Ä—å –° –û—á–∫–æ–º", "–ì–Ω–æ–π–Ω—ã–π –õ–∏–Ω—å—á–∏–∫–∞—Ä—å", "–ú–∞–≥–∏—Å—Ç—Ä –ó–∞–¥–Ω–µ–ø—Ä–æ—Ö–æ–¥–∞",
    "–¢—Ä–∏–ø–ø–µ—Ä–Ω—ã–π –ë—É—à–æ–Ω–æ–∫", "–ö–∏—à–∫–∞-–ü–µ—Ä–¥—É—à–∞", "–ê–Ω—É—Å–æ—Ä–∞–∑—Ä—É—à–∏—Ç–µ–ª—å", "–°–∏–ø—É–Ω –ì–ª—É–±–æ–∫–æ–≥–æ –û—á–∫–∞", "–ö–∏–∫—à–µ–≤—ã–π –ì—Ä–æ–º–∏–ª–∞",
    "–û—á–∫–æ–Ω–æ—Å–Ω—ã–π –ê—Ä—Ö–æ–Ω—Ç", "–ê–Ω—É—Å–æ–µ–¥ –õ–∏–Ω—å—á–∏–∫–æ–≤", "–ë—É—à–∏–∑–º–æ–≤–æ–¥ –û—á–∫–æ–≤—ã–π", "–ö–∏—à–∫–∞-–í–æ–Ω—é—á–∫–∞", "–°–∏–ø–æ–Ω–æ—Å–µ—Ü –ê–Ω—É—Å–æ–≤",
    "–ü–∞—Ö–æ–≤—ã–π –õ–∏–Ω—å—á–∏–∫–∞—Ä—å", "–ó–∞–¥–Ω–µ–ø—Ä–æ—Ö–æ–¥–Ω—ã–π –ü—Ä–æ—Ä–æ–∫", "–ö–∏—à–∫–∞ –ú—è—Å–Ω–∞—è", "–õ–∏–Ω—å—á–∏–∫–æ–∞–Ω—É—Å", "–û—á–∫–æ–≤—ã–π –®–∞–º–∞–Ω",
    "–ö–∏—à–∫–∞-–†–∞–∑—Ä—É—à–∏—Ç–µ–ª—å", "–ê–Ω—É—Å–Ω—ã–π –û—Ä–∞–∫—É–ª", "–ë—É—à–∏—Å—Ç –°—Ä–∞–Ω—ã–π", "–ì–Ω–æ–π–Ω–æ-–°–∏–ø—É—á–∏–π", "–ö–∏—à–∫–∞-–í–µ—Ä—Ç–æ–ª—ë—Ç",
    "–û—á–∫–æ–¥–∞–≤ –ë—É—à–∏–∑–º–∞", "–°—Ä–∞–ª—å–Ω—ã–π –õ–∏–Ω—å—á–∏–∫–∞—Ä—å", "–ö–∏–∫—à–µ–≤—ã–π –°–æ—Å–∞–ª—å—â–∏–∫", "–ê–Ω—É—Å–æ–æ–±–Ω–∏–º–∞—Ç–µ–ª—å", "–õ–∏–Ω—å—á–∏–∫–æ—Ä–∞–∑—Ä—ã–≤–∞—Ç–µ–ª—å",
    "–°–∏–ø–∞—Ä—å –û—á–∫–æ–≤—ã–π", "–ö–∏—à–∫–∞-–ú–æ—á–∞–ª–∫–∞", "–ë—É—à–∏–∑–º–æ–≤—ã–π –ì–æ–≤–Ω–∞—Ä—å", "–û—á–∫–æ–≤—ã–π –ö–∏–∫—à–µ–≤–æ–¥", "–ê–Ω—É—Å–æ–Ω–æ—Å–Ω—ã–π –õ–∏–Ω—å—á–∏–∫–∞—Ä—å",
    "–ö–∏—à–∫–∞ –°—ã—Ä–Ω–∞—è", "–û—á–∫–æ—Å–æ—Å –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π", "–õ–∏–Ω—å—á–∏–∫–æ–æ—á–∫–æ–µ–¥", "–ö–∏—à–∫–∞-–°–≤–∏–Ω—Ç—É—Å", "–û—á–∫–æ–¥–∞–≤–µ—Ü –ë—É—à–∏—Å—Ç—ã–π",
    "–ê–Ω—É—Å–æ–≤—ã–π –ì—Ä–æ–∑–∞", "–ö–∏—à–∫–∞ –ü–ª–µ—Å–Ω–µ–≤–µ–ª–∞—è", "–°–∏–ø–∞—Ä—å –ì–ª—É–±–∏–Ω–Ω—ã–π", "–û—á–∫–æ—Ä–∞–∑—Ä—É—à–∏—Ç–µ–ª—å –õ–∏–Ω—å—á–∏–∫–æ–≤", "–ö–∏—à–∫–∞ –ö–∏—Å–ª–æ—Ç–Ω–∞—è",
    "–ë—É—à–∏–∑–º–æ–ø–µ—Ä–¥—É–Ω", "–û—á–∫–æ–≤—ã–π –ü–æ–≤–µ–ª–∏—Ç–µ–ª—å", "–ö–∏—à–∫–∞-–í–µ–Ω–µ—Ä–∏—á–∫–∞", "–õ–∏–Ω—å—á–∏–∫–æ–æ—á–∫–æ–≤—ã–π", "–ì–Ω–æ–π–Ω–æ-–ö–∏–∫—à–µ–≤—ã–π",
    "–ê–Ω—É—Å–æ–Ω–æ—Å–∏—Ç–µ–ª—å", "–ö–∏—à–∫–∞-–•—Ä—é—à–∞", "–û—á–∫–æ–≤—ã–π –õ–∏–Ω—å—á–∏–∫–∞—Ä—å", "–°–∏–ø–∞—Ä—å –ê–Ω—É—Å–Ω—ã–π", "–ö–∏—à–∫–∞-–ñ–º—É—Ä", "–û—á–∫–æ–∑–∞–≤—Ä",
    "–ê–Ω—É—Å–æ—Ä–∞–∑–¥—É–≤–∞—Ç–µ–ª—å", "–õ–∏–Ω—å—á–∏–∫–æ–∞–Ω–∞–ª—å–Ω—ã–π", "–ö–∏—à–∫–∞-–ë—Ä—ã–∑–≥—É–Ω", "–û—á–∫–æ–≤—ã–π –†—ã—Ü–∞—Ä—å", "–ì–Ω–æ–π–Ω—ã–π –û—á–∫–æ–µ–¥",
    "–ö–∏—à–∫–∞-–ú–∞–∑–æ—Ö–∏—Å—Ç", "–ê–Ω—É—Å–æ–æ—á–∏—Å—Ç–∏—Ç–µ–ª—å", "–û—á–∫–æ–∫–∏–¥–∞—Ç–µ–ª—å", "–ö–∏—à–∫–∞-–ß–µ—Ä–≤–∏–≤—ã–π", "–ë—É—à–∏–∑–º–æ—Å—Ä–∞–∫–æ–ª–∏–∑",
    "–û—á–∫–æ–≤—ã–π –ò–Ω–∫–≤–∏–∑–∏—Ç–æ—Ä", "–ö–∏—à–∫–∞-–ü–µ—Ä–¥–µ–ª–∫–∞", "–ê–Ω—É—Å–æ—Ç—Ä—è—Å", "–°–∏–ø–∞—Ä—å –°—Ä–∞–ª—å–Ω—ã–π", "–û—á–∫–æ—Å–µ–∫—É—â–∏–π",
    "–ö–∏—à–∫–∞-–ó–∞–¥–Ω–µ–ø—Ä–∏–≤–æ–¥–Ω—ã–π", "–õ–∏–Ω—å—á–∏–∫–æ—Å–æ—Å –ê–Ω—É—Å–æ–≤", "–û—á–∫–æ–Ω–æ—Å–µ—Ü", "–ö–∏—à–∫–∞-–í—à–∏–≤–∫–∞", "–ê–Ω—É—Å–æ–±—É—à–æ–Ω–æ–∫",
    "–û—á–∫–æ–≤—ã–π –ó–≤–µ—Ä—å", "–ö–∏—à–∫–∞-–°—Ä–∞—á–º–µ–π—Å—Ç–µ—Ä", "–ì–Ω–æ–π–Ω–æ-–ê–Ω—É—Å–Ω—ã–π", "–û—á–∫–æ—Ç—Ä–æ–Ω 3000", "–ö–∏—à–∫–∞-–ë—É—à–∏—Å—Ç",
    "–ê–Ω—É—Å–æ–¥—É—à–∏—Ç–µ–ª—å", "–û—á–∫–æ–≤—ã–π –ú—Ä–∞–∫", "–ö–∏—à–∫–∞-–ü–µ—Ä–¥–∞—á", "–ê–Ω—É—Å–æ—Ä–µ–∑", "–û—á–∫–æ–≤—ã–π –õ–∏–Ω—å—á–∏–∫–æ–µ–¥", "–ö–∏—à–∫–∞-–°–∏–ø–∞—Ä—å",
    "–ë—É—à–∏–∑–º–æ—á–∫–æ–µ–¥", "–û—á–∫–æ–≤—ã–π –í–æ–Ω—é—á–∫–∞", "–ö–∏—à–∫–∞-–ê–Ω—É—Å–æ–Ω–æ—Å", "–°–∏–ø–∞—Ä—å –û—á–∫–æ–≤—ã–π –ì—Ä–æ–∑–Ω—ã–π", "–ü–æ–ø–æ—á–∫–∞ —Å —Å–∏—Å–µ—á–∫–∞–º–∏",
    "–ê–Ω—É—Å–æ—Ä–∞–∑–±–æ–π–Ω–∏–∫", "–ö–∏—à–∫–∞-–û—á–∫–æ–≤–µ—Ä—Ç", "–û—á–∫–æ–≤—ã–π –õ–∏–Ω—å—á–∏–∫–æ—Ä–∞–∑—Ä—É—à–∏—Ç–µ–ª—å",
    "–õ–µ–ø–º–∞–Ω –ú–∞—Å—Ç–µ—Ä –ü—Ä–æ–ª–∏–≤–Ω—ã—Ö –î–æ–∂–¥–µ–π", "–õ–µ–ø–º–∞–Ω –õ–∏–Ω—å—á–∏–∫–æ–≤—ã–π –ì–ª–∞–¥–∏–∞—Ç–æ—Ä", "–õ–µ–ø–º–∞–Ω –°–Ω—é—Å –Ω–∞ –í–µ—á–µ—Ä",
    "–õ–µ–ø–º–∞–Ω –•—Ä–∞–Ω–∏—Ç–µ–ª—å –ü—Ä–µ–≤–æ—Ä–∫–∞—É—Ç–∞", "–õ–µ–ø–º–∞–Ω –ü–∏—Å–∞—Ç–µ–ª—å –ë–∏—Ç–æ–≤", "–õ–µ–ø–º–∞–Ω –ü–∏—Å–∞—Ç—å—Å—è –ò–¥—ë–º", "–õ–µ–ø–º–∞–Ω –°–Ω–æ—à–∞—é—â–∏–π –†—Ç—ã",
    "–õ–µ–ø–º–∞–Ω –õ–µ–≥–µ–Ω–¥–∞ –ñ—ë–ª—Ç–æ–≥–æ –ü–æ—Ç–æ–∫–∞", "–õ–µ–ø–º–∞–Ω –Ø –†–µ–∞–ª—å–Ω–æ –ö—Ä–∞—Å–∏–≤—ã–π", "–õ–µ–ø–º–∞–Ω –í–ª–∞—Å—Ç–µ–ª–∏–Ω –õ–∏–Ω—å—á–∏–∫–∞", "–õ–µ–ø–º–∞–Ω –ú–∞—Å—Ç–µ—Ä 30 –°–µ–∫—É–Ω–¥",
    "–õ–µ–ø–º–∞–Ω –§–∏–ª–æ—Å–æ—Ñ –£–Ω–∏—Ç–∞–∑–∞", "–õ–µ–ø–º–∞–Ω –ü—Ä–æ–∫–ª—è—Ç—ã–π –õ–∏–Ω—å—á–∏–∫–µ—Ä", "–õ–µ–ø–º–∞–Ω –®–∞–º–∞–Ω –ñ–µ–ª—Ç—ã—Ö –î–æ–∂–¥–µ–π", "–õ–µ–ø–º–∞–Ω –°–Ω—é—Å–Ω—ã–π –£–Ω–∏—Ç–∞–∑–∏—Å—Ç",
    "–õ–µ–ø–º–∞–Ω –†–∞–∑–≥–æ–Ω –î–æ 110", "–õ–µ–ø–º–∞–Ω –ß–µ–ª–æ–≤–µ–∫-–°–Ω—é—Å", "–õ–µ–ø–º–∞–Ω –ë–∏—Ç–º–µ–π–∫–µ—Ä –õ–∏–Ω—å—á–∏–∫–∞", "–õ–µ–ø–º–∞–Ω –ü—Ä–µ–≤–æ—Ä–∫–∞—É—Ç–Ω—ã–π",
    "–õ–µ–ø–º–∞–Ω –°–Ω—é—Å–æ-–í–∞—Ä–≤–∞—Ä", "–õ–µ–ø–º–∞–Ω –ì—Ä–æ–∑–∞ –ö–Ω–∏–≥-–ú–æ—á–∏", "–õ–µ–ø–º–∞–Ω –ñ–µ–ª–µ–∑–Ω—ã–π –ü—Ä–µ–≤–æ—Ä–∫–∞—É—Ç", "–õ–µ–ø–º–∞–Ω –ñ—ë–ª—Ç—ã–π –ü–æ—Ç–æ–∫",
    "–õ–µ–ø–º–∞–Ω –ú–æ—á–µ–≤–æ–π –ú–∞–≥–∏—Å—Ç—Ä", "–õ–µ–ø–º–∞–Ω –í–ª–∞—Å—Ç–µ–ª–∏–Ω –ë–∞–ª–¥—ã", "–õ–µ–ø–º–∞–Ω –õ–∏–Ω—å—á–∏–∫–æ–≤—ã–π –ú—Å—Ç–∏—Ç–µ–ª—å", "–õ–µ–ø–º–∞–Ω –õ–µ–≥–µ–Ω–¥–∞ –°–Ω—é—Å–∞",
    "–õ–µ–ø–º–∞–Ω –ö–Ω–∏–≥–∞-–°–Ω—é—Å", "–õ–µ–ø–º–∞–Ω –ú–∞—Å—Ç–µ—Ä –ë—É—Ç—ã–ª–æ—á–Ω–æ–≥–æ –î–æ–∂–¥—è", "–õ–µ–ø–º–∞–Ω –ö–æ—Ä–æ–ª—å –ü—Ä–æ–¥—Ä–∏—Å—Ç–∏", "–õ–µ–ø–º–∞–Ω –°–Ω—é—Å–æ-–†–æ–∫–µ—Ä",
    "–õ–µ–ø–º–∞–Ω –ú–æ–∫—Ä—ã–π –õ–∏–Ω—å—á–∏–∫", "–õ–µ–ø–º–∞–Ω –ñ–µ–ª–µ–∑–Ω—ã–π –õ–µ–∂—É–Ω", "–õ–µ–ø–º–∞–Ω –ü—Ä–µ–≤–æ—Ä–∫–∞—É—Ç–Ω—ã–π –®–∞–º–∞–Ω", "–õ–µ–ø–º–∞–Ω –°–Ω—é—Å–æ-–ë–æ—Å—Å",
    "–õ–µ–ø–º–∞–Ω –ö–Ω–∏–≥–∞-–ì—Ä–æ–∑–∞", "–õ–µ–ø–º–∞–Ω –ñ—ë–ª—Ç—ã–π –ü—Ä–∏–∑—ã–≤–∞—Ç–µ–ª—å", "–õ–µ–ø–º–∞–Ω –õ–∏–Ω—å—á–∏–∫–æ–≤—ã–π –ü—Ä–∏–Ω—Ü", "–õ–µ–ø–º–∞–Ω –ì—Ä–æ–∑–∞ –õ—é–∫—Å–∞",
    "–õ–µ–ø–º–∞–Ω –ú–∞—Ä–∞—Ñ–æ–Ω—â–∏–∫ –õ–∏–Ω—å—á–∏–∫–∞", "–õ–µ–ø–º–∞–Ω –ü–∞–ø–∞ –ü—Ä–æ–¥—Ä–∏—Å—Ç–∏", "–õ–µ–ø–º–∞–Ω –õ–µ–≥–µ–Ω–¥–∞ –ú–∞—Ä–∞—Ñ–æ–Ω–∞", "–õ–µ–ø–º–∞–Ω –ñ–µ–ª–µ–∑–Ω—ã–π –°–Ω—é—Å-–ú–∞–≥",
    "–õ–µ–ø–º–∞–Ω –ö–æ—Ä–æ–ª—å –û–∫–æ–Ω–Ω—ã—Ö –î–æ–∂–¥–µ–π", "–õ–µ–ø–º–∞–Ω –ú–∞—Å—Ç–µ—Ä –ü–æ—Ç–æ–∫–æ–≤", "–õ–µ–ø–º–∞–Ω –ë–∞–ª–¥—É-–ö–∞—Ä–∞—Ç–µ–ª—å", "–õ–µ–ø–º–∞–Ω –°–Ω—é—Å–Ω—ã–π –§–∏–ª–æ—Å–æ—Ñ",
    "–õ–µ–ø–º–∞–Ω –ü—Ä–µ–≤–æ—Ä–∫–∞—É—Ç–Ω—ã–π –ë–∞—Ä–æ–Ω", "–õ–µ–ø–º–∞–Ω –õ–∏–Ω—å—á–∏–∫–æ–≤—ã–π –†–∞–∑—Ä—É—à–∏—Ç–µ–ª—å", "–õ–µ–ø–º–∞–Ω –ì—Ä–æ–∑–∞ –°–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∏", "–õ–µ–ø–º–∞–Ω –ñ—ë–ª—Ç—ã–π –ú–∞–≥",
    "–õ–µ–ø–º–∞–Ω –í–ª–∞—Å—Ç–µ–ª–∏–Ω –ü—Ä–æ–¥—Ä–∏—Å—Ç—å", "–õ–µ–ø–º–∞–Ω –ú–∞—Ä–∞—Ñ–æ–Ω –õ—é–∫—Å–æ–≤", "–õ–µ–ø–º–∞–Ω –ñ–µ–ª–µ–∑–Ω—ã–π –ë–∞–ª–∞–±–æ–ª", "–õ–µ–ø–º–∞–Ω –°–Ω—é—Å–Ω—ã–π –ë—Ä–æ–¥—è–≥–∞",
    "–õ–µ–ø–º–∞–Ω –ü—Ä–µ–≤–æ—Ä–∫–∞—É—Ç–Ω—ã–π –ì–ª–∞–¥–∏–∞—Ç–æ—Ä", "–õ–µ–ø–º–∞–Ω –õ–∏–Ω—å—á–∏–∫–æ–≤—ã–π –ü–µ–≤–µ—Ü", "–õ–µ–ø–º–∞–Ω –ú–∞—Å—Ç–µ—Ä –ñ—ë–ª—Ç–æ–≥–æ –ü–æ—Ç–æ–∫–∞", "–õ–µ–ø–º–∞–Ω –ö–Ω–∏–≥–∞-–í–æ–∏–Ω",
    "–õ–µ–ø–º–∞–Ω –°–Ω—é—Å–æ-–õ–µ–≥–µ–Ω–¥–∞", "–õ–µ–ø–º–∞–Ω –ñ–µ–ª–µ–∑–Ω—ã–π –ü–æ—Ç–æ—á–Ω–∏–∫", "–õ–µ–ø–º–∞–Ω –ì—Ä–æ–∑–∞ 110", "–õ–µ–ø–º–∞–Ω –ú–∞—Ä–∞—Ñ–æ–Ω –ú–æ—á–∏",
    "–õ–µ–ø–º–∞–Ω –í–ª–∞—Å—Ç–µ–ª–∏–Ω –õ–∏–Ω—å—á–∏–∫–æ–≤—ã—Ö –ù–æ—á–µ–π", "–õ–µ–ø–º–∞–Ω –ú–∞—Å—Ç–µ—Ä –ü—Ä–æ–¥—Ä–∏—Å—Ç—å", "–õ–µ–ø–º–∞–Ω –°–Ω—é—Å–Ω—ã–π –ü—Ä–∏–Ω—Ü", "–õ–µ–ø–º–∞–Ω –ë–∞–ª–¥—É-–õ–æ–º–∞—Ç–µ–ª—å",
    "–õ–µ–ø–º–∞–Ω –ñ–µ–ª–µ–∑–Ω—ã–π –ö–Ω–∏–≥–∞—á", "–õ–µ–ø–º–∞–Ω –õ–∏–Ω—å—á–∏–∫–æ–≤—ã–π –®—É—Ç–Ω–∏–∫", "–õ–µ–ø–º–∞–Ω –ü—Ä–µ–≤–æ—Ä–∫–∞—É—Ç–Ω—ã–π –õ–µ–≤", "–õ–µ–ø–º–∞–Ω –ñ—ë–ª—Ç—ã–π –î–∂–µ–¥–∞–π",
    "–õ–µ–ø–º–∞–Ω –ö–Ω–∏–≥–∞-–ì–ª–∞–¥–∏–∞—Ç–æ—Ä", "–õ–µ–ø–º–∞–Ω –°–Ω—é—Å–æ-–ì–µ—Ä–æ–π", "–õ–µ–ø–º–∞–Ω –ú–∞—Å—Ç–µ—Ä –õ—é–∫—Å–æ–≤", "–õ–µ–ø–º–∞–Ω –ì—Ä–æ–∑–∞ –õ–∏–Ω—å—á–∏–∫–∞",
    "–õ–µ–ø–º–∞–Ω –ñ–µ–ª–µ–∑–Ω—ã–π –î–æ–∂–¥–µ–≤–∏–∫", "–õ–µ–ø–º–∞–Ω –ü—Ä–µ–≤–æ—Ä–∫–∞—É—Ç–Ω—ã–π –°–æ–∫–æ–ª", "–õ–µ–ø–º–∞–Ω –õ–∏–Ω—å—á–∏–∫–æ–≤—ã–π –õ–µ–≤–∏–∞—Ñ–∞–Ω", "–õ–µ–ø–º–∞–Ω –°–Ω—é—Å–Ω—ã–π –†—ã—Ü–∞—Ä—å",
    "–õ–µ–ø–º–∞–Ω –õ–µ–≥–µ–Ω–¥–∞ –ö–Ω–∏–≥", "–õ–µ–ø–º–∞–Ω –ñ–µ–ª–µ–∑–Ω—ã–π –ú–æ—á–µ–≤–∏–∫", "–õ–µ–ø–º–∞–Ω –ü—Ä–µ–≤–æ—Ä–∫–∞—É—Ç–Ω—ã–π –ß–∞—Ä–æ–¥–µ–π", "–õ–µ–ø–º–∞–Ω –ú–∞—Ä–∞—Ñ–æ–Ω—Å–∫–∏–π –ñ—Ä–µ—Ü",
    "–õ–µ–ø–º–∞–Ω –ë–∞–ª–¥—É-–†–∞–∑—Ä—É—à–∏—Ç–µ–ª—å", "–õ–µ–ø–º–∞–Ω –õ–∏–Ω—å—á–∏–∫–æ–≤—ã–π –û—Ä—ë–ª", "–õ–µ–ø–º–∞–Ω –ñ—ë–ª—Ç—ã–π –§–∞—Ä–∞–æ–Ω", "–õ–µ–ø–º–∞–Ω –°–Ω—é—Å–Ω—ã–π –ì—É—Ä—É",
    "–õ–µ–ø–º–∞–Ω –ö–Ω–∏–≥–∞-–¶–∞—Ä—å", "–õ–µ–ø–º–∞–Ω –ü—Ä–µ–≤–æ—Ä–∫–∞—É—Ç–Ω—ã–π –í–æ–ª–∫", "–õ–µ–ø–º–∞–Ω –ñ–µ–ª–µ–∑–Ω—ã–π –®–∞–º–∞–Ω", "–õ–µ–ø–º–∞–Ω –ì—Ä–æ–∑–∞ –ü–æ—Ç–æ–∫–æ–≤",
    "–õ–µ–ø–º–∞–Ω –ú–∞—Ä–∞—Ñ–æ–Ω –õ–∏–Ω—å—á–∏–∫–∞", "–õ–µ–ø–º–∞–Ω –õ–∏–Ω—å—á–∏–∫–æ–≤—ã–π –®–∞–º–∞–Ω", "–õ–µ–ø–º–∞–Ω –°–Ω—é—Å–æ-–ú–∞—Å—Ç–µ—Ä", "–õ–µ–ø–º–∞–Ω –ö–Ω–∏–≥–∞-–í–ª–∞—Å—Ç–µ–ª–∏–Ω",
    "–õ–µ–ø–º–∞–Ω –ñ—ë–ª—Ç—ã–π –ì–ª–∞–¥–∏–∞—Ç–æ—Ä", "–õ–µ–ø–º–∞–Ω –ü—Ä–µ–≤–æ—Ä–∫–∞—É—Ç–Ω—ã–π –õ–µ–≥–µ–Ω–¥", "–õ–µ–ø–º–∞–Ω –ñ–µ–ª–µ–∑–Ω—ã–π –õ–∏–Ω—å—á–∏–∫–µ—Ä", "–õ–µ–ø–º–∞–Ω –ë–∞–ª–¥—É-–ú–æ–Ω–∞—Ä—Ö",
    "–õ–µ–ø–º–∞–Ω –õ–∏–Ω—å—á–∏–∫–æ–≤—ã–π –í–ª–∞—Å—Ç–µ–ª–∏–Ω", "–õ–µ–ø–º–∞–Ω –°–Ω—é—Å–Ω—ã–π –õ–µ–≤", "–õ–µ–ø–º–∞–Ω –ú–∞—Ä–∞—Ñ–æ–Ω–Ω—ã–π –î–∂–∏–Ω", "–õ–µ–ø–º–∞–Ω –ñ—ë–ª—Ç—ã–π –ë–æ—Å—Å",
    "–õ–µ–ø–º–∞–Ω –ü—Ä–µ–≤–æ—Ä–∫–∞—É—Ç–Ω—ã–π –ü–∞–ø–∞", "–õ–µ–ø–º–∞–Ω –ö–Ω–∏–≥–∞-–ë–∞–ª–∞–±–æ–ª", "–õ–µ–ø–º–∞–Ω –ñ–µ–ª–µ–∑–Ω—ã–π –õ—é–∫—Å", "–õ–µ–ø–º–∞–Ω –°–Ω—é—Å–æ-–ë–æ–≥",
    "–õ–µ–ø–º–∞–Ω –ì—Ä–æ–∑–∞ –ú–∞—Ä–∞—Ñ–æ–Ω–∞", "–õ–µ–ø–º–∞–Ω –õ–∏–Ω—å—á–∏–∫–æ–≤—ã–π –ü–∞–ø–∞", "–õ–µ–ø–º–∞–Ω –ú–∞—Ä–∞—Ñ–æ–Ω—â–∏–∫ –õ—é–∫—Å–æ–≤", "–õ–µ–ø–º–∞–Ω –ñ—ë–ª—Ç—ã–π –ì—Ä–æ–∑–∞",
    "–õ–µ–ø–º–∞–Ω –ë–∞–ª–¥—É-–õ–µ–≥–µ–Ω–¥–∞", "–õ–µ–ø–º–∞–Ω –ü—Ä–µ–≤–æ—Ä–∫–∞—É—Ç–Ω—ã–π –û—Ä—ë–ª", "–õ–µ–ø–º–∞–Ω –ö–Ω–∏–≥–∞-–ü–æ—Ç–æ–∫", "–õ–µ–ø–º–∞–Ω –ñ–µ–ª–µ–∑–Ω—ã–π –ú–∞—Ä–∞—Ñ–æ–Ω–µ—Ü",
    "–õ–µ–ø–º–∞–Ω –°–Ω—é—Å–æ-–í–ª–∞—Å—Ç–µ–ª–∏–Ω", "–õ–µ–ø–º–∞–Ω –õ–∏–Ω—å—á–∏–∫–æ–≤—ã–π –í–æ–ª–∫", "–õ–µ–ø–º–∞–Ω –ñ—ë–ª—Ç—ã–π –®–∞–º–∞–Ω", "–õ–µ–ø–º–∞–Ω –ë–∞–ª–¥—É-–ú–∞–≥–∏—Å—Ç—Ä",
    "–õ–µ–ø–º–∞–Ω –ü—Ä–µ–≤–æ—Ä–∫–∞—É—Ç–Ω—ã–π –ì—Ä–æ–∑–∞", "–õ–µ–ø–º–∞–Ω –ö–Ω–∏–≥–∞-–î–æ–∂–¥–µ–≤–∏–∫", "–õ–µ–ø–º–∞–Ω –ñ–µ–ª–µ–∑–Ω—ã–π –ü–æ—Ç–æ–∫", "–õ–µ–ø–º–∞–Ω –°–Ω—é—Å–æ-–û—Ä—ë–ª",
    "–õ–µ–ø–º–∞–Ω –õ–∏–Ω—å—á–∏–∫–æ–≤—ã–π –ë–∞—Ä–æ–Ω", "–õ–µ–ø–º–∞–Ω –ú–∞—Ä–∞—Ñ–æ–Ω—Å–∫–∏–π –í–æ–ª–∫", "–õ–µ–ø–º–∞–Ω –ñ—ë–ª—Ç—ã–π –õ–µ–≥–µ–Ω–¥", "–õ–µ–ø–º–∞–Ω –ë–∞–ª–¥—É-–ü–∞–ø–∞",
    "–õ–µ–ø–º–∞–Ω –ü—Ä–µ–≤–æ—Ä–∫–∞—É—Ç–Ω—ã–π –ú–∞—Å—Ç–µ—Ä", "–õ–µ–ø–º–∞–Ω –ö–Ω–∏–≥–∞-–û—Ä—ë–ª", "–õ–µ–ø–º–∞–Ω –ñ–µ–ª–µ–∑–Ω—ã–π –í–ª–∞—Å—Ç–µ–ª–∏–Ω", "–õ–µ–ø–º–∞–Ω –°–Ω—é—Å–æ-–î–∂–µ–¥–∞–π",
    "–õ–µ–ø–º–∞–Ω –õ–∏–Ω—å—á–∏–∫–æ–≤—ã–π –î–∂–∏–Ω", "–õ–µ–ø–º–∞–Ω –ú–∞—Ä–∞—Ñ–æ–Ω—Å–∫–∏–π –õ–µ–≤", "–õ–µ–ø–º–∞–Ω –ñ—ë–ª—Ç—ã–π –ü—Ä–∏–∑—Ä–∞–∫", "–õ–µ–ø–º–∞–Ω –ë–∞–ª–¥—É-–ì–µ—Ä–æ–π",
    "–õ–µ–ø–º–∞–Ω –ü—Ä–µ–≤–æ—Ä–∫–∞—É—Ç–Ω—ã–π –õ–∏–Ω—å—á–∏–∫–µ—Ä", "–õ–µ–ø–º–∞–Ω –ö–Ω–∏–≥–∞-–ì—Ä–æ–∑–∞", "–õ–µ–ø–º–∞–Ω –ñ–µ–ª–µ–∑–Ω—ã–π –õ–µ–≤", "–õ–µ–ø–º–∞–Ω –°–Ω—é—Å–æ-–§–∞—Ä–∞–æ–Ω",
    "–õ–µ–ø–º–∞–Ω –õ–∏–Ω—å—á–∏–∫–æ–≤—ã–π –ë–æ–≥", "–õ–µ–ø–º–∞–Ω –ú–∞—Ä–∞—Ñ–æ–Ω—Å–∫–∏–π –õ–∏–Ω—å—á–∏–∫", "–õ–µ–ø–º–∞–Ω –ñ—ë–ª—Ç—ã–π –ö–Ω–∏–≥–∞—á", "–õ–µ–ø–º–∞–Ω –ë–∞–ª–¥—É-–ú–æ—á–µ–≤–∏–∫",
    "–õ–µ–ø–º–∞–Ω –ü—Ä–µ–≤–æ—Ä–∫–∞—É—Ç–Ω—ã–π –ü–æ—Ç–æ–∫", "–õ–µ–ø–º–∞–Ω –ö–Ω–∏–≥–∞-–ú–∞—Ä–∞—Ñ–æ–Ω–µ—Ü", "–õ–µ–ø–º–∞–Ω –°–∏–ø-–º–∞—Å—Ç–µ—Ä", "–õ–µ–ø–º–∞–Ω –í–µ–ª–∏–∫–∏–π –°–∏–ø—É–Ω",
    "–õ–µ–ø–º–∞–Ω –°–∏–ø-–ë–∞—Ä–æ–Ω", "–õ–µ–ø–º–∞–Ω –õ–µ–≥–µ–Ω–¥–∞ –°–∏–ø–∞", "–õ–µ–ø–º–∞–Ω –ö–æ—Ä–æ–ª—å –°–∏–ø–∞", "–õ–µ–ø–º–∞–Ω –°–∏–ø—É–Ω –ì–ª–∞–¥–∏–∞—Ç–æ—Ä",
    "–õ–µ–ø–º–∞–Ω –°–∏–ø-–ì—Ä–æ–∑–∞", "–õ–µ–ø–º–∞–Ω –°–∏–ø—É–Ω –®–∞–º–∞–Ω", "–õ–µ–ø–º–∞–Ω –°–∏–ø–Ω—ã–π –í–æ–ª–∫", "–õ–µ–ø–º–∞–Ω –ú–∞—Ä–∞—Ñ–æ–Ω –°–∏–ø–∞"
]

STATE_FILE = "state.json"


# ==== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï ====
def load_state():
    try:
        with open(STATE_FILE, "r", encoding="utf-8") as f:
            return json.load(f)
    except FileNotFoundError:
        return {}

def save_state(state):
    with open(STATE_FILE, "w", encoding="utf-8") as f:
        json.dump(state, f, ensure_ascii=False, indent=2)

def nickname_core(n: str) -> str:
    # —É–±–∏—Ä–∞–µ–º –ø—Ä–µ—Ñ–∏–∫—Å "–õ–µ–ø–º–∞–Ω" –∏ —Ç–∏—Ä–µ, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å; –∏–Ω–∞—á–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–∞–∫ –µ—Å—Ç—å
    s = n
    if s.lower().startswith("–ª–µ–ø–º–∞–Ω"):
        s = s[len("–õ–µ–ø–º–∞–Ω"):].strip(" ‚Äî-")
    return s.strip()

def pick_for_history(history: list[str]) -> str:
    pool = [n for n in NICKNAMES if n not in history]
    if not pool:
        history.clear()
        pool = NICKNAMES[:]
    choice = random.choice(pool)
    history.append(choice)
    if len(history) > 7:
        history.pop(0)
    return choice

def pick_name_html(chat_id: int) -> str:
    """–î–ª—è /lep –∏ –∫–Ω–æ–ø–∫–∏: ¬´–õ–µ–ø–º–∞–Ω ‚Äî <i>‚Ä¶</i>¬ª —Å —É—á—ë—Ç–æ–º –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–∞"""
    state = load_state()
    entry = state.get(str(chat_id)) or {"history": []}
    nick = pick_for_history(entry["history"])
    state[str(chat_id)] = entry
    save_state(state)
    core = nickname_core(nick)
    return f"<b>–õ–µ–ø–º–∞–Ω</b> ‚Äî <i>{core}</i>"

def ensure_chat_entry(chat_id: int):
    state = load_state()
    if str(chat_id) not in state:
        state[str(chat_id)] = {"history": []}
        save_state(state)

# ==== –ö–û–ú–ê–ù–î–´/–•–ï–ù–î–õ–ï–†–´ ====
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    kb = ReplyKeyboardMarkup([[BTN_GEN]], resize_keyboard=True)
    await update.effective_message.reply_text("–∂–º–∏ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ ‚Üì", reply_markup=kb)

async def lep_cmd(update: Update, context: ContextTypes.DEFAULT_TYPE):
    html = pick_name_html(update.effective_chat.id)
    await context.bot.send_message(
        chat_id=update.effective_chat.id,
        text=html,
        parse_mode="HTML"
    )

async def on_button(update: Update, context: ContextTypes.DEFAULT_TYPE):
    if (update.effective_message.text or "").strip() == BTN_GEN:
        html = pick_name_html(update.effective_chat.id)
        await update.effective_message.reply_html(html)

async def set_daily(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–í–∫–ª—é—á–∞–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é –≤—ã–¥–∞—á—É –¥–ª—è *—Ç–µ–∫—É—â–µ–≥–æ —á–∞—Ç–∞* –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç, –∫–æ–≥–æ —Ç—ç–≥–∞—Ç—å."""
    chat_id = str(update.effective_chat.id)
    user = update.effective_user
    username = user.username or user.first_name or "–¥—Ä—É–≥"

    state = load_state()
    entry = state.get(chat_id) or {"history": []}
    entry["target"] = {"id": user.id, "username": username}
    state[chat_id] = entry
    save_state(state)

    await update.effective_message.reply_text("–ë—É–¥—É –≤—ã–¥–∞–≤–∞—Ç—å —Ç–µ–±–µ –ø–æ–≥–æ–Ω—è–ª–æ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 12:00 –ø–æ –ú–°–ö")

async def stop_daily(update: Update, context: ContextTypes.DEFAULT_TYPE):
    chat_id = str(update.effective_chat.id)
    state = load_state()
    if chat_id in state and ("target" in state[chat_id]):
        # –Ω–µ —É–¥–∞–ª—è–µ–º –∏—Å—Ç–æ—Ä–∏—é —Ü–µ–ª–∏–∫–æ–º ‚Äî —Ç–æ–ª—å–∫–æ —Ü–µ–ª—å —Ä–∞—Å—Å—ã–ª–∫–∏
        del state[chat_id]["target"]
        save_state(state)
        await update.effective_message.reply_text("–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –≤—ã–¥–∞—á–∞ –≤ —ç—Ç–æ–º —á–∞—Ç–µ –æ—Ç–∫–ª—é—á–µ–Ω–∞.")
    else:
        await update.effective_message.reply_text("–í —ç—Ç–æ–º —á–∞—Ç–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–∞—è –≤—ã–¥–∞—á–∞ –∏ —Ç–∞–∫ –≤—ã–∫–ª—é—á–µ–Ω–∞.")

async def daily_job(context: ContextTypes.DEFAULT_TYPE):
    """–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞: ¬´@username ‚Äî *–ø–æ–≥–æ–Ω—è–ª–æ*¬ª –≤ –∫–∞–Ω–∞–ª–µ/—á–∞—Ç–µ, –≥–¥–µ –≤–∫–ª—é—á–∏–ª–∏."""
    state = load_state()
    updates = False
    for chat_id, entry in state.items():
        target = entry.get("target")
        if not target:
            continue
        # –ø–æ–¥–æ–±—Ä–∞—Ç—å –Ω–∏–∫ –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–æ–≤ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 7
        nick_full = pick_for_history(entry.setdefault("history", []))
        core = nickname_core(nick_full)
        username = target.get("username") or "–¥—Ä—É–≥"

        # –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ —á–∞—Ç, —Ñ–æ—Ä–º–∞—Ç '@username ‚Äî *–ø–æ–≥–æ–Ω—è–ª–æ*'
        try:
            await context.bot.send_message(
                chat_id=int(chat_id),
                text=f"@{username} ‚Äî *{core}* üé©",
                parse_mode="Markdown"
            )
        except Exception as e:
            # –µ—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å ‚Äî –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–ø—É—Å—Ç–∏–º
            print(f"daily send failed for {chat_id}: {e}")
        updates = True

    if updates:
        save_state(state)

# ==== MAIN ====
def main():
    app = ApplicationBuilder().token(TOKEN).build()

    # –µ–∂–µ–¥–Ω–µ–≤–Ω–∞—è –∑–∞–¥–∞—á–∞ –≤ 12:00 –ø–æ –ú–°–ö
    msk = pytz.timezone("Europe/Moscow")
    app.job_queue.run_daily(daily_job, time(hour=12, minute=0, tzinfo=msk))

    # –∫–æ–º–∞–Ω–¥—ã/—Ö–µ–Ω–¥–ª–µ—Ä—ã
    app.add_handler(CommandHandler("start", start))
    app.add_handler(CommandHandler("lep", lep_cmd))
    app.add_handler(CommandHandler("setdaily", set_daily))
    app.add_handler(CommandHandler("stopdaily", stop_daily))
    app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, on_button))

    app.run_polling()

if __name__ == "__main__":
    main()

